<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>freeablo: Freeablo Architecture</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">freeablo
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Modules</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Freeablo Architecture </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Freeablo's source code is split up into two sections, apps and components. Apps can depend on components, and components can depend on eachother, but components cannot depend on apps. The idea of this arrangement is to separate out common code that can be used in multiple programs into common libraries, so for example the launcher and the main game executable can both use the mpq file IO library.</p>
<p>Tests live in the tests/ folder. See <a class="el" href="md_docs_tests.html">Tests</a>.</p>
<p>I won't try to list all the components here, as it's sure to go out of date, but I'll gloss over a few of the most important ones.</p>
<h3>Components</h3>
<ul>
<li><a class="el" href="namespace_cel.html" title="Library for loading blizzard CEL and CL2 files. ">Cel</a>, responsible for loading Diablo's CEL and CL2 image files into plain rgba buffers. There is some documentation available on these files here: <a href="https://github.com/wheybags/fyp">https://github.com/wheybags/fyp</a> (yes, freeablo was my final year college project originally :p), but it is somewhat out of date. Another good resource for these is <a href="https://github.com/mewrnd/blizzconv">https://github.com/mewrnd/blizzconv</a>.</li>
<li><a class="el" href="namespace_render.html" title="Wrapper for low-level rendering library. ">Render</a>, interface for rendering objects and levels. Also handles GUI rendering currently.</li>
<li><a class="el" href="namespace_f_a_i_o.html" title="Transparently load files from filesystem or mpq archives. ">FAIO</a>, provides an fopen-style api for reading files from MPQ archives. Allows overriding files in DIABDAT.MPQ with files in the current directory.</li>
<li><a class="el" href="namespace_diablo_exe.html" title="loads various bts of necessary information that was hardcoded into the original exe file ...">DiabloExe</a>, interface for loading the portions of game data which were unfortunately hardcoded into the original game's executable.</li>
<li><a class="el" href="namespace_serial.html">Serial</a>, interface for serialising data into a bitstream (bit as opposed to byte-oriented). Based loosely on this blog series: <a href="http://gafferongames.com/building-a-game-network-protocol/">http://gafferongames.com/building-a-game-network-protocol/</a></li>
</ul>
<p>The freeablo project itself is actually just a single main.cpp, with all the actual freeablo code technically arranged as a library in the same folder. This was done so that unit tests can link to freeablo's internal classes.</p>
<p>Within the actual freeablo game codebase, the code is also split up into a number of namespaces/directories. As I did with components, I'll try to list a few of the most important ones here.</p>
<h3>freeablo namespaces</h3>
<ul>
<li><a class="el" href="namespace_f_a_world.html">FAWorld</a>, basically holds the state for objects in the world, so levels, players, npcs, items, etc. FAWorld::FAWorld is the class that contains the whole lot, with <a class="el" href="class_f_a_world_1_1_actor.html">FAWorld::Actor</a> representing players, npcs and monsters with the subclasses <a class="el" href="class_f_a_world_1_1_player.html">FAWorld::Player</a>, and <a class="el" href="class_f_a_world_1_1_monster.html">FAWorld::Monster</a> ([possibly out of date when you read this] NPCS are currently just instances of <a class="el" href="class_f_a_world_1_1_actor.html">FAWorld::Actor</a> directly, but this should be changed at some point as they do have their unique attributes [can talk to them, for one]).</li>
<li><a class="el" href="namespace_f_a_render.html" title="Rendering. ">FARender</a>, a higher-level interface for rendering that wraps the <a class="el" href="namespace_render.html" title="Wrapper for low-level rendering library. ">Render</a> component. It handles spawning a separate thread dedicated to rendering, and sending the game state to that thread for rendering when needed. It wraps sprites to be drawn with a class (FARender::SpriteGroup) that is basically just an index into a cache of sprites (<a class="el" href="class_f_a_render_1_1_sprite_cache.html" title="Multithread sprite cache. ">FARender::SpriteCache</a>), that will be lazy-loaded by the render thread when they are needed for drawing. The indices from this cache are also used for synchronising sprites across multiplayer games, but this will be covered in more detail in the <a class="el" href="md_docs_multiplayer.html">multiplayer</a> section.</li>
<li><a class="el" href="namespace_f_a_level_gen.html" title="Level generation. ">FALevelGen</a>, handles generation of levels. [may be out of date] Currently uses the awesome tinykeep dungeon generation algorithm (<a href="https://www.reddit.com/r/gamedev/comments/1dlwc4/procedural_dungeon_generation_algorithm_explained/">algorithm</a>, <a href="http://tinykeep.com/dungen/">demo</a>). If you're looking at some fancy AI stuff, and thinking of adding flocking to monster AI, the algorithm includes an implementation of (reverse)flocking, so that might be of use. </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
